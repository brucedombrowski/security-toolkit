{
  "$schema": "../schema.json",
  "standard": "NIST SP 800-53 Rev 5",
  "title": "Security and Privacy Controls for Information Systems and Organizations",
  "url": "https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final",
  "controls": {
    "AU-2": {
      "family": "Audit and Accountability",
      "title": "Event Logging",
      "description": "Identify the types of events that the system is capable of logging in support of the audit function.",
      "implementation": {
        "status": "implemented",
        "scripts": [],
        "libraries": ["lib/audit-log.sh"],
        "notes": "JSON Lines audit logging with timestamps, user, host, and event details"
      }
    },
    "AU-3": {
      "family": "Audit and Accountability",
      "title": "Content of Audit Records",
      "description": "Ensure that audit records contain information that establishes what type of event occurred, when it occurred, where it occurred, the source, outcome, and identity.",
      "implementation": {
        "status": "implemented",
        "scripts": [],
        "libraries": ["lib/audit-log.sh"],
        "notes": "Audit records include timestamp, hostname, username, PID, scan_type, event, and details fields"
      }
    },
    "CA-2": {
      "family": "Assessment, Authorization, and Monitoring",
      "title": "Control Assessments",
      "description": "Assess the controls in the system to determine the extent to which the controls are implemented correctly and producing the desired outcome.",
      "implementation": {
        "status": "implemented",
        "scripts": ["scan-vulnerabilities.sh", "generate-compliance.sh"],
        "libraries": ["lib/scanners/nist-controls.sh"],
        "notes": "Automated control assessment via vulnerability scanning and compliance statement generation"
      }
    },
    "CM-6": {
      "family": "Configuration Management",
      "title": "Configuration Settings",
      "description": "Establish and document configuration settings for components employed within the system.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-host-security.sh", "harden-system.sh"],
        "libraries": [],
        "notes": "Verifies SIP, Gatekeeper, FileVault, firewall settings on macOS; provides hardening guidance"
      }
    },
    "CM-8": {
      "family": "Configuration Management",
      "title": "System Component Inventory",
      "description": "Develop and document an inventory of system components that accurately reflects the system.",
      "implementation": {
        "status": "implemented",
        "scripts": ["collect-host-inventory.sh", "Collect-HostInventory.ps1"],
        "libraries": ["lib/inventory/"],
        "notes": "Comprehensive inventory of OS, hardware, network, software, and security tools"
      }
    },
    "MP-6": {
      "family": "Media Protection",
      "title": "Media Sanitization",
      "description": "Sanitize system media prior to disposal, release, or reuse.",
      "implementation": {
        "status": "implemented",
        "scripts": ["secure-delete.sh", "purge-git-history.sh"],
        "libraries": [],
        "notes": "NIST SP 800-88 Clear method with 3-pass overwrite for files; git history purging for sensitive data"
      }
    },
    "RA-5": {
      "family": "Risk Assessment",
      "title": "Vulnerability Monitoring and Scanning",
      "description": "Monitor and scan for vulnerabilities in the system and hosted applications.",
      "implementation": {
        "status": "implemented",
        "scripts": ["scan-vulnerabilities.sh", "check-nvd-cves.sh", "check-kev.sh"],
        "libraries": ["lib/scanners/", "lib/nvd/"],
        "notes": "Nmap port scanning, Lynis auditing, NVD CVE lookup, CISA KEV cross-reference"
      }
    },
    "SA-11": {
      "family": "System and Services Acquisition",
      "title": "Developer Testing and Evaluation",
      "description": "Require the developer of the system to create and implement a plan for ongoing security testing.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-secrets.sh"],
        "libraries": [],
        "notes": "Detects hardcoded credentials, API keys, private keys, and database connection strings"
      }
    },
    "SC-8": {
      "family": "System and Communications Protection",
      "title": "Transmission Confidentiality and Integrity",
      "description": "Protect the confidentiality and integrity of transmitted information.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-mac-addresses.sh"],
        "libraries": [],
        "notes": "Identifies MAC addresses that could expose network topology; supports CUI protection"
      }
    },
    "SI-2": {
      "family": "System and Information Integrity",
      "title": "Flaw Remediation",
      "description": "Identify, report, and correct system flaws.",
      "implementation": {
        "status": "implemented",
        "scripts": ["scan-vulnerabilities.sh", "check-nvd-cves.sh"],
        "libraries": ["lib/scanners/", "lib/nvd/"],
        "notes": "Identifies vulnerabilities and CVEs for remediation prioritization"
      }
    },
    "SI-3": {
      "family": "System and Information Integrity",
      "title": "Malicious Code Protection",
      "description": "Implement malicious code protection mechanisms at system entry and exit points.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-malware.sh"],
        "libraries": [],
        "notes": "ClamAV-based malware scanning with automatic signature updates"
      }
    },
    "SI-4": {
      "family": "System and Information Integrity",
      "title": "System Monitoring",
      "description": "Monitor the system to detect attacks, indicators of potential attacks, and unauthorized connections.",
      "implementation": {
        "status": "implemented",
        "scripts": ["scan-vulnerabilities.sh"],
        "libraries": ["lib/scanners/"],
        "notes": "Network port monitoring via Nmap, system auditing via Lynis"
      }
    },
    "SI-5": {
      "family": "System and Information Integrity",
      "title": "Security Alerts, Advisories, and Directives",
      "description": "Receive system security alerts and advisories from external organizations on an ongoing basis.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-kev.sh"],
        "libraries": [],
        "notes": "Cross-references against CISA Known Exploited Vulnerabilities catalog (BOD 22-01)"
      }
    },
    "SI-12": {
      "family": "System and Information Integrity",
      "title": "Information Management and Retention",
      "description": "Manage and retain information within the system and information output from the system.",
      "implementation": {
        "status": "implemented",
        "scripts": ["check-pii.sh", "purge-git-history.sh", "redact-examples.sh"],
        "libraries": [],
        "notes": "PII detection (SSN, phone, credit card, IP), git history purging, example file redaction"
      }
    }
  }
}
